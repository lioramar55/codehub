<div class="h-screen flex flex-col">
  <!-- Room header -->
  <header class="h-14 flex items-center gap-3 px-4 border-b bg-white">
    <div class="p-4 flex items-center gap-3 group border-r">
      <img
        [src]="currentUser().avatarUrl"
        alt="avatar"
        class="h-10 w-10 rounded-full"
      />
      <div class="font-semibold">{{ currentUser().name }}</div>
    </div>

    <div class="font-semibold text-gray-800">CodeHub</div>
    <div class="ml-auto text-sm text-gray-600 relative group">
      <span class="inline-flex items-center gap-2">
        <span class="h-2 w-2 rounded-full bg-green-500"></span>
        {{ participants().length }} online
      </span>
      <div
        class="hidden group-hover:block absolute right-0 mt-2 w-56 rounded-md border bg-white p-2 shadow"
      >
        @for (p of participants(); track p.id) {
        <div class="px-2 py-1 text-sm">{{ p.name }}</div>
        }
      </div>
    </div>
  </header>

  <!-- Messages -->
  <main #scrollable class="flex-1 overflow-y-auto p-4 bg-bg-chat">
    <app-message-list
      [timeline]="timeline()"
      [currentUserId]="currentUser().id"
    />
  </main>

  <!-- Composer -->
  <footer class="border-t bg-white p-3">
    @if (typingNames().length > 0) {
    <div class="px-3 pb-2 text-xs text-gray-500 flex items-center gap-2">
      <span class="relative inline-flex items-center gap-2">
        <span class="inline-flex h-2 w-2 rounded-full bg-green-500"></span>
        {{ typingNames().join(', ') }} is typing
        <span class="inline-flex gap-1 ml-1 align-middle">
          <span class="dot animate-bounce [animation-delay:-0.2s]">•</span>
          <span class="dot animate-bounce [animation-delay:-0.1s]">•</span>
          <span class="dot animate-bounce">•</span>
        </span>
      </span>
    </div>
    }
    <app-message-input
      [userId]="currentUser().id"
      (send)="onSendText($event)"
    />
  </footer>
</div>
